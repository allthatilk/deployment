---
- hosts: validator-dev-ansible
  remote_user: root
  gather_facts: false
  roles:
    - common/python2
    - dev_validator/validator_setup
    - common/clone_repo

  tasks:

  - name: Create an upload directory
    file:
      path: /var/www/html/IATI-Public-Validator/upload
      state: directory
      mode: 0755

  - name: Make a copy of the settings.php file
    copy:
      remote_src: yes
      src: /var/www/html/IATI-Public-Validator/example.settings.php
      dest: /var/www/html/IATI-Public-Validator/settings.php

  - name: Replace default settings with appropriate variables
    replace:
      path: /var/www/html/IATI-Public-Validator/settings.php
      regexp: '$host = "http://localhost/Webs/validate-me/";'
      replace: '$host = "123";'
      backup: yes
